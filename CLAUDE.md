# Claude Prose - Development Guide

## Project Awareness
Building a robust session management and evolution system (claude-prose) featuring a web-based viewer, temporal search, and CWD-aware CLI tools.

## Critical Decisions
- **Horizontal Evolution with a fixed rolling window constraint.**: To improve session snapshot compression and predictability while avoiding complex algorithmic pruning.
- **Zero-config CWD-awareness for CLI commands (search, evolve, status).**: To improve developer ergonomics by automatically detecting the active project based on the current directory.
- **Fast incremental evolution using stat() checks and byte-offset reading.**: To minimize token usage and processing time by only analyzing new messages in a session.
- **Interactive web dashboard via `claude-prose serve`.**: To provide a browsable interface for project fragments (Decisions, Insights, Gotchas) and historical session data.
- **Renamed /memory command to /flash.**: To prevent namespace collisions with built-in Claude Code commands.
- **Global configuration via ~/.config/claude-prose/.env.**: To securely manage API keys and settings outside of the project codebase.
- **Opt-in background evolution via `init hooks`.**: To allow automatic memory updates during the `/compact` cycle without forcing it on all developers.

## Project Insights
- Using `stat()` checks and byte-offset reading allows for 'zero-parsing' checks, significantly speeding up the detection of sessions that actually need processing.
- A 'zero-config' philosophy driven by CWD-awareness (Current Working Directory) reduces user friction by auto-detecting the active project for status, search, and evolution.
- 'Horizontal Evolution' (compressing the last N snapshots) combined with temporal search (recency-weighted relevance) provides a more predictable and useful context than complex algorithmic pruning.
- Using Gemini Flash for semantic extraction keeps costs low (~$0.07/session), making frequent background evolution viable.
- Providing an `init hooks` command allows developers to opt-in to auto-evolution during `/compact` via gitignored hooks, ensuring memory stays fresh without manual intervention.

## Active Gotchas
- **Incorrect project matching using `includes()` caused expensive processing of unrelated projects.**: Use exact matches or strict `-projectname` suffix matching for project filtering.
- **Token usage bloat and non-incremental evolution when processing entire session files.**: Implemented fast incremental updates using `stat()` checks and byte-offset reading to process only new messages.
- **Command name collision with built-in environment commands (specifically `/memory`).**: Renamed the command to `/flash`.

## Usage Instructions
### ðŸ§  Semantic Memory & Search
This project uses `claude-prose` to maintain a cross-session semantic memory of decisions, insights, and story beats.

- **Semantic Search**: If you're unsure about a past decision or need context on a feature, run:
  ```bash
  claude-prose search "your question or keywords"
  ```
- **Project Status**: To see a summary of recent sessions and evolved memory, run:
  ```bash
  claude-prose status
  ```
- **View Chronicles**: Run `claude-prose serve` to browse the interactive development timeline in your browser.


## Tech Stack
- Bun (Runtime & Test)
- TypeScript
- Commander.js (CLI)
- Gemini 3 Flash (via AI SDK)

## Development Workflow
- Build: `npm run build`
- Evolve memory: `node dist/cli.js evolve`
- Test: `bun test`


> [!NOTE]
> This file is automatically generated from `CLAUDE.md.template` by `claude-prose`.
> Last updated: 12/23/2025, 4:31:16 AM
