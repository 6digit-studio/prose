# Claude Prose - Development Guide

## Project Awareness
Implement an 'Ambient Context' system to automatically update CLAUDE.md using templates and project memory.

## Critical Decisions
- **Implement an 'Ambient Context' system using template-based CLAUDE.md injection.**: To provide Claude with project memory without intrusive shims, ensuring the LLM always has access to the latest decisions and insights via the standard CLAUDE.md file.
- **Use a 'CLAUDE.md.template' file with specific handlebars-style placeholders.**: Allows users to maintain their own custom CLAUDE.md structure (instructions, build commands) while letting the tool manage the dynamic memory sections.
- **Trigger the injection logic as the final step of the 'evolve' command.**: Ensures that as soon as the project memory is updated from a conversation, the project's primary context file is immediately synchronized.
- **Horizontal evolution using a fixed rolling window for session snapshot compression.**: To prioritize predictability and simplicity over complex pruning algorithms when managing the window of project information.
- **CWD-aware CLI architecture (status, evolve, search).**: To follow a 'zero-config' philosophy where the tool automatically detects the project context based on the user's current directory.
- **Fast incremental processing using stat() checks and byte-offset reading.**: To significantly speed up 'needs processing' checks and reduce token usage by avoiding full file parsing and only processing new messages.
- **Renamed /memory command to /flash.**: To avoid conflicts with built-in commands in the Claude Code environment.

## Project Insights
- An 'Ambient Context' system using a template-based injection (CLAUDE.md.template) allows for automated, non-intrusive updates to project documentation during the evolution workflow.
- The 'evolve' command is the ideal lifecycle hook for updating documentation, as it represents the moment new insights and decisions are finalized.
- Fast incremental evolution is achieved via stat() checks and byte-offset reading, ensuring that only new messages are processed, which significantly reduces token usage.
- CWD-awareness across commands (status, evolve, search) creates a 'zero-config' experience by automatically detecting the relevant project context based on the user's directory.
- 'Horizontal Evolution' uses a rolling window to compress session snapshots into a current state, prioritizing predictability and recency-based relevance over complex pruning algorithms.

## Active Gotchas
- **Placeholders with no data might leave ugly empty sections in CLAUDE.md.**: Handle empty memory states by replacing placeholders with a graceful "None yet" or similar placeholder text.
- **Incorrect project matching due to includes() check, leading to expensive processing of unrelated projects.**: Changed project filter to use exact match or strict -projectname suffix match.
- **Token usage growth and non-truly incremental evolution due to processing whole sessions instead of only new messages.**: Implemented incremental updates to process only NEW messages, using a rolling window of old fragments and new messages, and skipping empty sessions.
- **Conflict with a built-in command when using '/memory'.**: Renamed '/memory' command to '/flash'.

## Usage Instructions
### ðŸ§  Semantic Memory & Search
This project uses `claude-prose` to maintain a cross-session semantic memory of decisions, insights, and story beats.

- **Semantic Search**: If you're unsure about a past decision or need context on a feature, run:
  ```bash
  claude-prose search "your question or keywords"
  ```
- **Project Status**: To see a summary of recent sessions and evolved memory, run:
  ```bash
  claude-prose status
  ```
- **View Chronicles**: Run `claude-prose serve` to browse the interactive development timeline in your browser.


## Tech Stack
- Bun (Runtime & Test)
- TypeScript
- Commander.js (CLI)
- Gemini 3 Flash (via AI SDK)

## Development Workflow
- Build: `npm run build`
- Evolve memory: `node dist/cli.js evolve`
- Test: `bun test`


> [!NOTE]
> This file is automatically generated from `CLAUDE.md.template` by `claude-prose`.
> Last updated: 12/20/2025, 11:35:40 AM
